<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multilevel Models using lmer • multilevelTools</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multilevel Models using lmer">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multilevelTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lmer-vignette.html">Multilevel Models using lmer</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JWiley/multilevelTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multilevel Models using lmer</h1>
                        <h4 data-toc-skip class="author">Joshua F.
Wiley</h4>
            
            <h4 data-toc-skip class="date">2025-04-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JWiley/multilevelTools/blob/main/vignettes/lmer-vignette.Rmd" class="external-link"><code>vignettes/lmer-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>lmer-vignette.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to use the <code>multilevelTools</code>
package for further diagnostics and testing of mixed effects (a.k.a.,
multilevel) models using <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer()</a></code> from the <code>lme4</code>
package.</p>
<p>To get started, load the <code>lme4</code> package, which actually
fits the models, and the <code>multilevelTools</code> package. Although
not required, we load the <code>lmerTest</code> package to get
approximate degrees of freedom for use in calculating p-values for the
fixed effects. Without <code>lmerTest</code> p-values are based on
asymptotic normality. We will also load an example dataset from the
<code>JWileymisc</code> package, <code>aces_daily</code>, using the
<code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code> function. The <code>aces_daily</code> dataset is
simulated data from a daily, ecological momentary assessment study of
191 participants who completed ratings of <strong>a</strong>ctivity,
<strong>c</strong>oping, <strong>e</strong>motions, and
<strong>s</strong>tress (aces) up to three times per day for twelve
days. Only a subset of variables were simulated, but it is a nice
example of messy, real-world type data for mixed effects or multilevel
models.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## load lme4, JWileymisc, and multilevelTools packages</span></span>
<span><span class="co">## (i.e., "open the 'apps' ") </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR" class="external-link">lmerTest</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'lmerTest'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:lme4':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lmer</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     step</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joshuawiley.com/extraoperators/" class="external-link">extraoperators</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joshuawiley.com/JWileymisc/" class="external-link">JWileymisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joshuawiley.com/multilevelTools/">multilevelTools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## load some sample data for examples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">aces_daily</span>, package <span class="op">=</span> <span class="st">"JWileymisc"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="a-quick-view-of-the-data">A Quick View of the Data<a class="anchor" aria-label="anchor" href="#a-quick-view-of-the-data"></a>
</h3>
<p>Let’s start with a quick view of the <strong>str</strong>ucture of
the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## overall structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">aces_daily</span>, nchar.max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    6599 obs. of  19 variables:</span></span>
<span><span class="co">#&gt;  $ UserID            : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ SurveyDay         : Date, format: "2017-02-24" "2017-02-24" ...</span></span>
<span><span class="co">#&gt;  $ SurveyInteger     : int  2 3 1 2 3 1 2 3 1 2 ...</span></span>
<span><span class="co">#&gt;  $ SurveyStartTimec11: num  1.93e-01 4.86e-| __truncated__ ...</span></span>
<span><span class="co">#&gt;  $ Female            : int  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ Age               : num  21 21 21 21 21 21 21 21 21 21 ...</span></span>
<span><span class="co">#&gt;  $ BornAUS           : int  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ SES_1             : num  5 5 5 5 5 5 5 5 5 5 ...</span></span>
<span><span class="co">#&gt;  $ EDU               : int  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ SOLs              : num  NA 0 NA NA 6.92 ...</span></span>
<span><span class="co">#&gt;  $ WASONs            : num  NA 0 NA NA 0 NA NA 1 NA NA ...</span></span>
<span><span class="co">#&gt;  $ STRESS            : num  5 1 1 2 0 0 3 1 0 3 ...</span></span>
<span><span class="co">#&gt;  $ SUPPORT           : num  NA 7.02 NA NA 6.15 ...</span></span>
<span><span class="co">#&gt;  $ PosAff            : num  1.52 1.51 1.56 1.56 1.13 ...</span></span>
<span><span class="co">#&gt;  $ NegAff            : num  1.67 1 NA 1.36 1 ...</span></span>
<span><span class="co">#&gt;  $ COPEPrb           : num  NA 2.26 NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ COPEPrc           : num  NA 2.38 NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ COPEExp           : num  NA 2.41 NA NA 2.03 ...</span></span>
<span><span class="co">#&gt;  $ COPEDis           : num  NA 2.18 NA NA NA ...</span></span></code></pre></div>
<p>For this example, we will just work with negative affect,
<code>NegAff</code>, as the outcome variable and stress,
<code>STRESS</code>, as our predictor. Because observations are repeated
per person, we also need to use a variable that indicates which
observations belong to which person, <code>UserID</code>. The code that
follows shows how many unique people and observations we have for each
variable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## how many unique IDs (people) are there?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">aces_daily</span><span class="op">$</span><span class="va">UserID</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 191</span></span>
<span></span>
<span><span class="co">## how many not missing observations of negative affect are there?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">aces_daily</span><span class="op">$</span><span class="va">NegAff</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6389</span></span>
<span></span>
<span><span class="co">## how many not missing observations of stress are there?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">aces_daily</span><span class="op">$</span><span class="va">STRESS</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6402</span></span></code></pre></div>
<p>Finally, we might explore each variable briefly, before jumping into
analyzing them and examining diagnostics and effects of our models.
Using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function on each variable gives us some
basic descriptive statistics in the form of a five number summary
(minimum, first quartile, median (second quartile), third quartile, and
maximum) as well as the arithmetic mean. The NA’s tell us how many
observations are missing negative affect. We can see that both variables
are quite skewed as their minimum, first quartile and medians are all
close together and far away from the maximum.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aces_daily</span><span class="op">$</span><span class="va">NegAff</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt;   1.000   1.029   1.280   1.550   1.813   5.000     210</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aces_daily</span><span class="op">$</span><span class="va">STRESS</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt;   0.000   0.000   1.000   2.328   4.000  10.000     197</span></span></code></pre></div>
<p>Because these are repeated measures data, another useful descriptive
statistic is the intraclass correlation coefficient or ICC. The ICC is a
measure of the proportion of variance that is between people versus the
total variance (i.e., variance between people and variance within
persons). <code>multilevelTools</code> provides a function,
<code><a href="../reference/iccMixed.html">iccMixed()</a></code> to estimate ICCs based off of mixed effects /
multilevel models. The following code does this for negative affect and
stress, first naming all the arguments and then using shorter unnamed
approach, that is identical results, but easier to type. The relevant
output is the ICC for the row named <code>UserID</code>. An ICC of 1
indicates that 100% of all variance exists between people, which would
mean that 0% of variance exists within person, indicating that people
have identical scores every time they are assessed. Conversely an ICC of
0 would indicate that everyone’s average was identical and 100% of the
variance exists within person. For negative affect and stress, we can
see the ICCs fall between 0 and 1, indicating that some variance is
between people (i.e., individuals have different average levels of
negative affect and stress) but also that some variance is within
person, meaning that people’s negative affect and stress fluctuate or
vary within a person across the day and the 12-days of the study.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/iccMixed.html">iccMixed</a></span><span class="op">(</span></span>
<span>  dv <span class="op">=</span> <span class="st">"NegAff"</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"UserID"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">aces_daily</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Var     Sigma       ICC</span></span>
<span><span class="co">#&gt;      &lt;char&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:   UserID 0.2100950 0.4374139</span></span>
<span><span class="co">#&gt; 2: Residual 0.2702166 0.5625861</span></span>
<span></span>
<span><span class="fu"><a href="../reference/iccMixed.html">iccMixed</a></span><span class="op">(</span><span class="st">"STRESS"</span>, <span class="st">"UserID"</span>, <span class="va">aces_daily</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Var   Sigma       ICC</span></span>
<span><span class="co">#&gt;      &lt;char&gt;   &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:   UserID 2.04045 0.3228825</span></span>
<span><span class="co">#&gt; 2: Residual 4.27903 0.6771175</span></span></code></pre></div>
<p>Finally, we might want to examine the distribution of the variables
visually. Visual exploration is a great way to identify the distribution
of variables, extreme values, and other potential issues that can be
difficult to identify numerically, such as bimodal distributions. For
multilevel data, it is helpful to examine between and within person
aspects of a variable separately. <code>multilevelTools</code> makes
this easy using the <code><a href="../reference/meanDecompose.html">meanDecompose()</a></code> function. This is
important as, for example, if on 11 of 12 days, someone has a negative
affect score of 5, and then one day a score of 1, the score of 1 may be
an extreme value, for that person even though it is common for the rest
of the participants in the study. <code><a href="../reference/meanDecompose.html">meanDecompose()</a></code> returns a
list with <code>X</code> values at different levels, here by ID and the
residuals, which in this case are within person effects.</p>
<p>We make plots of the distributions using
<code><a href="https://joshuawiley.com/JWileymisc/reference/testDistribution.html" class="external-link">testDistribution()</a></code>, which defaults to testing against a
normal distribution, which is a common default and in our case
appropriate for linear mixed effects / multilevel models. The graphs
show a density plot in black lines, a normal distribution in dashed blue
lines, a rug plot showing where individual observations fall, and the
x-axis is a five number summary (minimum, first quartile, median, third
quartile, maximum). The bottom plot is a Quantile-Quantile plot rotated
to be horizontal instead of diagonal. Black dots / lines indicate
extreme values, based on the expected theoretical distribution, here
normal (gaussian), and specified percentile, <code>.001</code>. For more
details, see <code><a href="https://joshuawiley.com/JWileymisc/reference/testDistribution.html" class="external-link">help("testDistribution")</a></code>.</p>
<p>The between person results for negative affect show about five people
with relative extreme higher scores. Considering negative affect ranges
from 1 to 5, they are not impossible scores, but they are extreme
relative to the rest of this particular sample. At the within person
level, there are thousands of observations and there are many extreme
scores. Based on these results, we may suspect that when we get into our
mixed effects / multilevel model, there will be more extreme residual
scores to be dealt with (which roughly correspond to within person
results) than extreme random effects (which roughly correspond to
between person results).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meanDecompose.html">meanDecompose</a></span><span class="op">(</span><span class="va">NegAff</span> <span class="op">~</span> <span class="va">UserID</span>, data <span class="op">=</span> <span class="va">aces_daily</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tmp</span>, nchar.max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ NegAff by UserID  :Classes 'data.table' and 'data.frame': 191 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ UserID: int [1:191] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   ..$ X     : num [1:191] 1.75 1.12 1.68 1.79 1.1 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ NegAff by residual:Classes 'data.table' and 'data.frame': 6599 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   ..$ X: num [1:6599] -0.0787 -0.7478| __truncated__ ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/testDistribution.html" class="external-link">testDistribution</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">[[</span><span class="st">"NegAff by UserID"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                      extremevalues <span class="op">=</span> <span class="st">"theoretical"</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span>,</span>
<span>     varlab <span class="op">=</span> <span class="st">"Between Person Negative Affect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/testDistribution.html" class="external-link">testDistribution</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">[[</span><span class="st">"NegAff by residual"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                      extremevalues <span class="op">=</span> <span class="st">"theoretical"</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span>,</span>
<span>     varlab <span class="op">=</span> <span class="st">"Within Person Negative Affect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>The same exercise for stress shows a better between and within person
distribution. Certainly there is some skew and its not a perfect normal
distribution. However, neither of these are required for predictors in
mixed effects models. The extreme values are not that extreme or that
far away from the rest of the sample, so we might feel comfortable
proceeding with the data as is.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meanDecompose.html">meanDecompose</a></span><span class="op">(</span><span class="va">STRESS</span> <span class="op">~</span> <span class="va">UserID</span>, data <span class="op">=</span> <span class="va">aces_daily</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/testDistribution.html" class="external-link">testDistribution</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">[[</span><span class="st">"STRESS by UserID"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                      extremevalues <span class="op">=</span> <span class="st">"theoretical"</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span>,</span>
<span>     varlab <span class="op">=</span> <span class="st">"Between Person STRESS"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/testDistribution.html" class="external-link">testDistribution</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">[[</span><span class="st">"STRESS by residual"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                      extremevalues <span class="op">=</span> <span class="st">"theoretical"</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span>,</span>
<span>     varlab <span class="op">=</span> <span class="st">"Within Person STRESS"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="mixed-effects-multilevel-model">Mixed Effects (Multilevel) Model<a class="anchor" aria-label="anchor" href="#mixed-effects-multilevel-model"></a>
</h2>
<p>With a rough sense of our variables, we proceed to fitting a mixed
effects model using the <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer()</a></code> function from
<code>lme4</code>. Here we use negative affect as the outcome predicted
by stress. Both the intercept and linear slope of stress on negative
affect are included as fixed and random effects. The random effects are
allowed to be correlated, so that, for example, people who have higher
negative affect under low stress may also have a flatter slope as thye
may have less room to increase in negative affect at higher stress
levels.</p>
<p>At the time of writing, this model using the default optimizer and
control criteria fails to converge (albeit the gradient is very close).
These convergence warnings can be spurious but also may suggest either a
too complex model or need to refine some other aspect of the model, such
as scaling predictors or changing the optimizer or arguments to the
optimizer.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">NegAff</span> <span class="op">~</span> <span class="va">STRESS</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">STRESS</span> <span class="op">|</span> <span class="va">UserID</span><span class="op">)</span>,</span>
<span>          data <span class="op">=</span> <span class="va">aces_daily</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span><span class="co">#&gt; Model failed to converge with max|grad| = 0.00201381 (tol = 0.002, component 1)</span></span></code></pre></div>
<p>Here we use the <code><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl()</a></code> function to specify a
different optimization algorithm using the Nelder-Mead Method (<a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method" class="external-link uri">https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</a>).
We also tighten the tolerance values. This is then passed to
<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer()</a></code> by setting the argument,
<code>control = strictControl</code>. This converges without
warning.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">strictControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>   algorithm <span class="op">=</span> <span class="st">"NLOPT_LN_NELDERMEAD"</span>,</span>
<span>   xtol_abs <span class="op">=</span> <span class="fl">1e-12</span>,</span>
<span>   ftol_abs <span class="op">=</span> <span class="fl">1e-12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">NegAff</span> <span class="op">~</span> <span class="va">STRESS</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">STRESS</span> <span class="op">|</span> <span class="va">UserID</span><span class="op">)</span>,</span>
<span>          data <span class="op">=</span> <span class="va">aces_daily</span>, control <span class="op">=</span> <span class="va">strictControl</span><span class="op">)</span></span></code></pre></div>
<p>Now we move on to examine model diagnostics. For linear mixed effects
/ multilevel models, the residuals should follow a normal distribution,
the random effects should follow a multivariate normal distribution, and
the residual variance should be homogenous (the same) as a single
residual variance is estimated and used for the whole model. The
<code><a href="https://joshuawiley.com/JWileymisc/reference/modelDiagnostics.html" class="external-link">modelDiagnostics()</a></code> function in <code>multilevelTools</code>
helps to evaluate these assumptions graphically.</p>
<p>The first plot shows (top left) the distribution of residuals. It is
somewhat too narrow for a normal distribution (i.e., leptokurtic) and
consequently many of the residuals on both tails are considered extreme
values. However, the distribution is fairly symmetrical and for the
residuals we have over 6,000 observations which will tend to make
results relatively robust to violations.</p>
<p>The second plot (top right) shows the fitted (predicted) values for
each observation against the residuals. The colour of the blocks
indicates how many observations fall at a particular point. The solid
blue line is a loess smooth line. Hopefully this line is about flat and
stays consistently at residuals of 0 regardless of the predicted value,
indicating no systematic bias. Finally the dashed blue lines indicate
the 10th and 90th percentile (estimated from a quantile regression
model) of the residuals across predicted values. If the residual
variance is homogenous across the spread of predicted values, we would
expect these dashed lines to be flat and parallel to each other. That is
approximately true for all predicted values above about 1.7. For low
predicted values, the residuals are 0 or higher and the spread of the
dashed lines is narrowed. This is because people cannot have negative
affect scores below 1 and many people reported negative affect around 1.
Therefore for predicted negative affect scores of 1, the residuals tend
to be about 0. This pattern is not ideal, but also not indicative of a
terrible violation of the assumption. Two possible approaches to
relaxing the assumption given data like these would be to use a censored
model, that assumes true negative affect scores may be lower but are
censored at 1 due to limitations in the measurement. Another would be to
use a location and scale mixed effects model that models not only the
mean (location) but also the scale (variance) as a function of some
variables, which would allow the residual variance to differ. These are
beyond the scope of this document, however.</p>
<p>The last three plots show the univariate distribution of the
intercept and stress slope by <code>UserID</code>, the random intercept
and slope and a test of whether the random intercept and slope are
multivariate normal The multivariate normality test, based on the
mahalonbis distances, suggests that there are a few, relatively extreme
people. We might consider dropping these individuals from the analysis
to examine whether results are sensitive to these extreme cases.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">md</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelDiagnostics.html" class="external-link">modelDiagnostics</a></span><span class="op">(</span><span class="va">m</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">md</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>In order to drop people who were extreme on the multivariate
normality test, we can access a data table of the extreme values from
the <code>modelDiagnostics</code> object. We subset it to only include
the multivariate effects and use the <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code> function to
show the first few rows. The extreme value table shows the scores on the
outcome, the <code>UserID</code>, the index (which row) in the dataset,
and the effect type, here all multivariate since we subset for that. We
can use the <code><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique()</a></code> function to identify the IDs, which
shows it is three IDs.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mvextreme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">md</span><span class="op">$</span><span class="va">extremeValues</span>,</span>
<span>  <span class="va">EffectType</span> <span class="op">==</span> <span class="st">"Multivariate Random Effect UserID"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mvextreme</span><span class="op">)</span></span>
<span><span class="co">#&gt;      NegAff UserID Index                        EffectType</span></span>
<span><span class="co">#&gt;       &lt;num&gt;  &lt;int&gt; &lt;int&gt;                            &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 3.861232     56  1929 Multivariate Random Effect UserID</span></span>
<span><span class="co">#&gt; 2: 2.362821     56  1930 Multivariate Random Effect UserID</span></span>
<span><span class="co">#&gt; 3: 3.145248     56  1931 Multivariate Random Effect UserID</span></span>
<span><span class="co">#&gt; 4: 2.574245     56  1932 Multivariate Random Effect UserID</span></span>
<span><span class="co">#&gt; 5: 1.955497     56  1933 Multivariate Random Effect UserID</span></span>
<span><span class="co">#&gt; 6: 1.848545     56  1934 Multivariate Random Effect UserID</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mvextreme</span><span class="op">$</span><span class="va">UserID</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  56 111 185</span></span></code></pre></div>
<p>We can update the existing model using the <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>
function and in the data, just subset to exclude those three extreme
IDs. We re-run the diagnostics and plot again revealing one new
multivariate extreme value.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">aces_daily</span>,</span>
<span>  <span class="va">UserID</span> <span class="op"><a href="https://joshuawiley.com/extraoperators/reference/logicals.html" class="external-link">%!in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mvextreme</span><span class="op">$</span><span class="va">UserID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">md2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelDiagnostics.html" class="external-link">modelDiagnostics</a></span><span class="op">(</span><span class="va">m2</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">md2</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mvextreme2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">md2</span><span class="op">$</span><span class="va">extremeValues</span>,</span>
<span>  <span class="va">EffectType</span> <span class="op">==</span> <span class="st">"Multivariate Random Effect UserID"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mvextreme2</span><span class="op">$</span><span class="va">UserID</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 123</span></span></code></pre></div>
<p>Again removing this further extreme ID and plotting diagnostics
suggests that now the random effects are fairly “clean”.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">aces_daily</span>,</span>
<span>  <span class="va">UserID</span> <span class="op"><a href="https://joshuawiley.com/extraoperators/reference/logicals.html" class="external-link">%!in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mvextreme</span><span class="op">$</span><span class="va">UserID</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mvextreme2</span><span class="op">$</span><span class="va">UserID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">md3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelDiagnostics.html" class="external-link">modelDiagnostics</a></span><span class="op">(</span><span class="va">m3</span>, ev.perc <span class="op">=</span> <span class="fl">.001</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">md3</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="lmer-vignette_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Now that we have a model whose diagnostics we are reasonably happy
with, we can examine the results. The <code><a href="https://joshuawiley.com/JWileymisc/reference/modelPerformance.html" class="external-link">modelPerformance()</a></code>
function from the <code>multilevelTools</code> package gives some fit
indices for the overall model, including measures of the variance
accounted for by the fixed effects (marginal R2) and from the fixed and
random effects combined (conditional R2). We also get information
criterion (AIC, BIC), although note that with a REML estimator, the log
likelihood and thus information criterion are not comparable to if the
ML estimator was used.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelPerformance.html" class="external-link">modelPerformance</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Performance</span></span>
<span><span class="co">#&gt;     Model Estimator N_Obs     N_Groups      AIC      BIC        LL  LLDF</span></span>
<span><span class="co">#&gt;    &lt;char&gt;    &lt;char&gt; &lt;num&gt;       &lt;char&gt;    &lt;num&gt;    &lt;num&gt;     &lt;num&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: merMod      REML  6262 UserID (187) 7173.374 7213.827 -3580.687     6</span></span>
<span><span class="co">#&gt;        Sigma MarginalR2 ConditionalR2 MarginalF2 ConditionalF2</span></span>
<span><span class="co">#&gt;        &lt;num&gt;      &lt;num&gt;         &lt;num&gt;      &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 0.4070053  0.2428357     0.5173029  0.3207174      1.071693</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "modelPerformance.merMod" "modelPerformance"</span></span></code></pre></div>
<p>To see the results of individual variables, we can use the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function to get the default model summary. Note
that this summary differs slightly from that produced by
<code>lme4</code> as it is overridden by <code>lmerTest</code> which
adds degrees of freedom and p-values.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">#&gt; lmerModLmerTest]</span></span>
<span><span class="co">#&gt; Formula: NegAff ~ STRESS + (1 + STRESS | UserID)</span></span>
<span><span class="co">#&gt;    Data: </span></span>
<span><span class="co">#&gt; subset(aces_daily, UserID %!in% c(unique(mvextreme$UserID), unique(mvextreme2$UserID)))</span></span>
<span><span class="co">#&gt; Control: strictControl</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML criterion at convergence: 7161.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -5.1249 -0.5156 -0.1579  0.4040  6.4032 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr</span></span>
<span><span class="co">#&gt;  UserID   (Intercept) 0.027950 0.16718      </span></span>
<span><span class="co">#&gt;           STRESS      0.003925 0.06265  0.43</span></span>
<span><span class="co">#&gt;  Residual             0.165653 0.40701      </span></span>
<span><span class="co">#&gt; Number of obs: 6262, groups:  UserID, 187</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error        df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 1.217e+00  1.456e-02 1.622e+02   83.64   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; STRESS      1.152e-01  5.473e-03 1.854e+02   21.05   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;        (Intr)</span></span>
<span><span class="co">#&gt; STRESS 0.103</span></span></code></pre></div>
<p>This default summary gives quite a bit of key information. However,
it does not provide some of the results that often are desired for
scientific publication. Confidence intervals are commonly reported and t
values often are not reported in preference for p-values. In addition,
it is increasingly common to ask for effect sizes. The
<code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> function in <code>multilevelTools</code>
provides further tests, including tests of the combined fixed + random
effect for each variable and effect sizes based off the independent
change in marginal and conditional R2, used to calculate a sort of
cohen’s F2. All of the results are available in a series of tables for
any programattic use. However, for individual use or reporting, caling
<code><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler()</a></code> will produce a nicely formatted output for
humans. Confidence intervals are added in brackets and the effect sizes
at the bottom are listed for stress considering fixed + random effects
together.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameters and CIs are based on REML, </span></span>
<span><span class="co">#&gt; but modelTests requires ML not REML fit for comparisons, </span></span>
<span><span class="co">#&gt; and these are used in effect sizes. Refitting.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mt3</span><span class="op">)</span> <span class="co">## list of all tables available</span></span>
<span><span class="co">#&gt; [1] "FixedEffects"  "RandomEffects" "EffectSizes"   "OverallModel"</span></span>
<span></span>
<span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="va">mt3</span><span class="op">)</span></span>
<span><span class="co">#&gt;                              Term                  Est           Type</span></span>
<span><span class="co">#&gt;                            &lt;char&gt;               &lt;char&gt;         &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:                   (Intercept) 1.22*** [1.19, 1.25]  Fixed Effects</span></span>
<span><span class="co">#&gt;  2:                        STRESS 0.12*** [0.10, 0.13]  Fixed Effects</span></span>
<span><span class="co">#&gt;  3: cor_STRESS.(Intercept)|UserID                 0.43 Random Effects</span></span>
<span><span class="co">#&gt;  4:         sd_(Intercept)|UserID                 0.17 Random Effects</span></span>
<span><span class="co">#&gt;  5:              sd_STRESS|UserID                 0.06 Random Effects</span></span>
<span><span class="co">#&gt;  6:                         sigma                 0.41 Random Effects</span></span>
<span><span class="co">#&gt;  7:                      Model DF                    6  Overall Model</span></span>
<span><span class="co">#&gt;  8:                    N (Groups)         UserID (187)  Overall Model</span></span>
<span><span class="co">#&gt;  9:              N (Observations)                 6262  Overall Model</span></span>
<span><span class="co">#&gt; 10:                        logLik             -3573.08  Overall Model</span></span>
<span><span class="co">#&gt; 11:                           AIC              7158.16  Overall Model</span></span>
<span><span class="co">#&gt; 12:                           BIC              7198.61  Overall Model</span></span>
<span><span class="co">#&gt; 13:                   Marginal R2                 0.24  Overall Model</span></span>
<span><span class="co">#&gt; 14:                   Marginal F2                 0.32  Overall Model</span></span>
<span><span class="co">#&gt; 15:                Conditional R2                 0.52  Overall Model</span></span>
<span><span class="co">#&gt; 16:                Conditional F2                 1.07  Overall Model</span></span>
<span><span class="co">#&gt; 17:       STRESS (Fixed + Random)  0.32/0.24, p &lt; .001   Effect Sizes</span></span>
<span><span class="co">#&gt; 18:               STRESS (Random) -0.07/0.01, p &lt; .001   Effect Sizes</span></span></code></pre></div>
<p>The output of <code><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler()</a></code> can easily be copied and
pasted into Excel or Word for formatting and publication. If the format
is not as desired, some changes are fairly easy to make automatically.
For example the following code uses 3 decimal points, lists exact
p-values, and uses a semi colon instead of a comma for confidence
intervals.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="va">mt3</span>,</span>
<span>          format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            FixedEffects <span class="op">=</span> <span class="st">"%s, %s (%s; %s)"</span>,</span>
<span>            RandomEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"%s"</span>, <span class="st">"%s (%s, %s)"</span><span class="op">)</span>,</span>
<span>            EffectSizes <span class="op">=</span> <span class="st">"%s, %s; %s"</span><span class="op">)</span>,</span>
<span>          digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>          pcontrol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, stars <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          includeP <span class="op">=</span> <span class="cn">TRUE</span>, includeSign <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          dropLeadingZero <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                              Term                            Est           Type</span></span>
<span><span class="co">#&gt;                            &lt;char&gt;                         &lt;char&gt;         &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:                   (Intercept) 1.217, p &lt; .001 (1.189; 1.246)  Fixed Effects</span></span>
<span><span class="co">#&gt;  2:                        STRESS 0.115, p &lt; .001 (0.104; 0.126)  Fixed Effects</span></span>
<span><span class="co">#&gt;  3: cor_STRESS.(Intercept)|UserID                          0.427 Random Effects</span></span>
<span><span class="co">#&gt;  4:         sd_(Intercept)|UserID                          0.167 Random Effects</span></span>
<span><span class="co">#&gt;  5:              sd_STRESS|UserID                          0.063 Random Effects</span></span>
<span><span class="co">#&gt;  6:                         sigma                          0.407 Random Effects</span></span>
<span><span class="co">#&gt;  7:                      Model DF                              6  Overall Model</span></span>
<span><span class="co">#&gt;  8:                    N (Groups)                   UserID (187)  Overall Model</span></span>
<span><span class="co">#&gt;  9:              N (Observations)                           6262  Overall Model</span></span>
<span><span class="co">#&gt; 10:                        logLik                      -3573.079  Overall Model</span></span>
<span><span class="co">#&gt; 11:                           AIC                       7158.158  Overall Model</span></span>
<span><span class="co">#&gt; 12:                           BIC                       7198.611  Overall Model</span></span>
<span><span class="co">#&gt; 13:                   Marginal R2                          0.243  Overall Model</span></span>
<span><span class="co">#&gt; 14:                   Marginal F2                          0.322  Overall Model</span></span>
<span><span class="co">#&gt; 15:                Conditional R2                          0.517  Overall Model</span></span>
<span><span class="co">#&gt; 16:                Conditional F2                          1.068  Overall Model</span></span>
<span><span class="co">#&gt; 17:       STRESS (Fixed + Random)         0.322, 0.242; p &lt; .001   Effect Sizes</span></span>
<span><span class="co">#&gt; 18:               STRESS (Random)        -0.069, 0.005; p &lt; .001   Effect Sizes</span></span></code></pre></div>
<p>Finally, <code><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler()</a></code> can be used with multiple models to
create a convenient comparison. For example, although we removed several
extreme values, we might want to compare the results in the full data to
the dataset with extreme values removed to evaluate whether critical
coefficients or effect sizes changed and if so how much. Some
quantities, like the log likelihood, AIC and BIC are not comparable as
the sample size changed. However, effect size estimates like the model
marginal and conditional R2 can be reasonably compared as can the fixed
effect coefficients and the effect sizes for particular predictors.</p>
<p>To create the output, we pass a list of <code>modelTest</code>
objects and we can add names so that they are more nicely named in the
output. The results show that the intercept, the predicted negative
affect when stress is zero is very slightly higher in the original than
in the model with outliers removed. The fixed effect coefficient for
stress is identical, but the confidence interval is very slightly wider
after removing outliers. Variability in the random intercept, slope, and
residual variance, sigma, are all slightly reduced. All in all, we could
conclude that the overall pattern of results and any conclusions that
might be drawn from them would not functionally change in the model with
all cases included versus after removing the extreme values, in this
case. This effectively serves as a “sensitivity analysis” evaluating how
sensitive the results of the model are to the inclusion / exclusion of
extreme values. In this case, not very sensitive, which may be
encouraging. In cases where there are large differences in the results,
careful thought may be needed around which model is more likely to be
“true” and what the implications of the differences are for
interpretting and utilizing the results.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## run modelTest() on the original model, m</span></span>
<span><span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameters and CIs are based on REML, </span></span>
<span><span class="co">#&gt; but modelTests requires ML not REML fit for comparisons, </span></span>
<span><span class="co">#&gt; and these are used in effect sizes. Refitting.</span></span>
<span></span>
<span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Original <span class="op">=</span> <span class="va">mt</span>, `Outliers Removed` <span class="op">=</span> <span class="va">mt3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                              Term             Original     Outliers Removed</span></span>
<span><span class="co">#&gt;                            &lt;char&gt;               &lt;char&gt;               &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:                   (Intercept) 1.24*** [1.20, 1.27] 1.22*** [1.19, 1.25]</span></span>
<span><span class="co">#&gt;  2:                        STRESS 0.12*** [0.11, 0.13] 0.12*** [0.10, 0.13]</span></span>
<span><span class="co">#&gt;  3: cor_STRESS.(Intercept)|UserID                 0.47                 0.43</span></span>
<span><span class="co">#&gt;  4:         sd_(Intercept)|UserID                 0.21                 0.17</span></span>
<span><span class="co">#&gt;  5:              sd_STRESS|UserID                 0.07                 0.06</span></span>
<span><span class="co">#&gt;  6:                         sigma                 0.42                 0.41</span></span>
<span><span class="co">#&gt;  7:                      Model DF                    6                    6</span></span>
<span><span class="co">#&gt;  8:                    N (Groups)         UserID (191)         UserID (187)</span></span>
<span><span class="co">#&gt;  9:              N (Observations)                 6389                 6262</span></span>
<span><span class="co">#&gt; 10:                        logLik             -3845.41             -3573.08</span></span>
<span><span class="co">#&gt; 11:                           AIC              7702.81              7158.16</span></span>
<span><span class="co">#&gt; 12:                           BIC              7743.39              7198.61</span></span>
<span><span class="co">#&gt; 13:                   Marginal R2                 0.23                 0.24</span></span>
<span><span class="co">#&gt; 14:                   Marginal F2                 0.29                 0.32</span></span>
<span><span class="co">#&gt; 15:                Conditional R2                 0.55                 0.52</span></span>
<span><span class="co">#&gt; 16:                Conditional F2                 1.23                 1.07</span></span>
<span><span class="co">#&gt; 17:       STRESS (Fixed + Random)  0.29/0.26, p &lt; .001  0.32/0.24, p &lt; .001</span></span>
<span><span class="co">#&gt; 18:               STRESS (Random) -0.06/0.02, p &lt; .001 -0.07/0.01, p &lt; .001</span></span>
<span><span class="co">#&gt;               Type</span></span>
<span><span class="co">#&gt;             &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:  Fixed Effects</span></span>
<span><span class="co">#&gt;  2:  Fixed Effects</span></span>
<span><span class="co">#&gt;  3: Random Effects</span></span>
<span><span class="co">#&gt;  4: Random Effects</span></span>
<span><span class="co">#&gt;  5: Random Effects</span></span>
<span><span class="co">#&gt;  6: Random Effects</span></span>
<span><span class="co">#&gt;  7:  Overall Model</span></span>
<span><span class="co">#&gt;  8:  Overall Model</span></span>
<span><span class="co">#&gt;  9:  Overall Model</span></span>
<span><span class="co">#&gt; 10:  Overall Model</span></span>
<span><span class="co">#&gt; 11:  Overall Model</span></span>
<span><span class="co">#&gt; 12:  Overall Model</span></span>
<span><span class="co">#&gt; 13:  Overall Model</span></span>
<span><span class="co">#&gt; 14:  Overall Model</span></span>
<span><span class="co">#&gt; 15:  Overall Model</span></span>
<span><span class="co">#&gt; 16:  Overall Model</span></span>
<span><span class="co">#&gt; 17:   Effect Sizes</span></span>
<span><span class="co">#&gt; 18:   Effect Sizes</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interactions">Interactions<a class="anchor" aria-label="anchor" href="#interactions"></a>
</h2>
<p>Interactions in models are generally supported by
<code>multilevelTools</code>. However, some functions, specifically
<code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> do not work equally well with all types of
interactions. <code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> has good support for interactions
with only continuous variables. It has somewhat worse support for
interactions involving one or more categorical variables.</p>
<div class="section level3">
<h3 id="interactions-with-categorical-variables">Interactions with Categorical Variable(s)<a class="anchor" aria-label="anchor" href="#interactions-with-categorical-variables"></a>
</h3>
<p>First let’s take a look at an example with all categorical variables.
We will start with a model that does not have any interactions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">aces_daily</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SES_1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">BornAUS</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">SEScat</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">SES_1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">BornAUScat</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">BornAUS</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">m.noint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">PosAff</span> <span class="op">~</span> <span class="va">BornAUScat</span> <span class="op">+</span> <span class="va">SEScat</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">UserID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></code></pre></div>
<p>Here are the fixed effeccts for the model with no interactions.</p>
<table class="table">
<caption>no interaction model fixed effects</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6283333</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1</td>
<td align="right">0.2111452</td>
</tr>
<tr class="odd">
<td align="left">SEScat5</td>
<td align="right">-0.1707281</td>
</tr>
<tr class="even">
<td align="left">SEScat6</td>
<td align="right">0.0307653</td>
</tr>
<tr class="odd">
<td align="left">SEScat7</td>
<td align="right">0.0216888</td>
</tr>
<tr class="even">
<td align="left">SEScat8</td>
<td align="right">0.0874991</td>
</tr>
</tbody>
</table>
<p>Now, suppose that we decided to drop one of the predictors from the
model. We can update the model using the <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> function
built into <code>R</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.nointdrop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m.noint</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">SEScat</span><span class="op">)</span></span></code></pre></div>
<p>Here are the fixed effeccts for the model with no interactions after
dropping categorical subjective socioeconomic status
(<code>SEScat</code>).</p>
<table class="table">
<caption>no interaction model fixed effects after dropping a
predictor</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6086056</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1</td>
<td align="right">0.2414211</td>
</tr>
</tbody>
</table>
<p>We can see that there are four less fixed effect coefficient. These
two models are called nested, because one model (the one dropping
<code>SEScat</code>) is fully nested or contained in the other model.
This is essentially what <code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> does for us
automatically and then it compares the two models. In the table that
follows, if you compare the Log Likelihood (LL) degrees of freedom (DF),
we can see that one model has 4 fewer degrees of freedom than the other,
reflecting a different number of parameters: the coefficients for
<code>SEScat</code> were dropped.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelCompare.html" class="external-link">modelCompare</a></span><span class="op">(</span><span class="va">m.nointdrop</span>, <span class="va">m.noint</span><span class="op">)</span><span class="op">$</span><span class="va">Comparison</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"model comparison"</span><span class="op">)</span></span>
<span><span class="co">#&gt; When using REML, the fixed effects structure must be identical,</span></span>
<span><span class="co">#&gt; but was different. Refitting with ML.</span></span></code></pre></div>
<table class="table">
<caption>model comparison</caption>
<tbody>
<tr class="odd">
<td align="left">Model</td>
<td align="left">Model 1</td>
<td align="left">Model 2</td>
<td align="left">Difference</td>
</tr>
<tr class="even">
<td align="left">Estimator</td>
<td align="left">ML</td>
<td align="left">ML</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">N_Obs</td>
<td align="left">6210</td>
<td align="left">6210</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">N_Groups</td>
<td align="left">UserID (185)</td>
<td align="left">UserID (185)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">AIC</td>
<td align="left">14311.531185</td>
<td align="left">14317.515173</td>
<td align="left">5.983988</td>
</tr>
<tr class="even">
<td align="left">BIC</td>
<td align="left">14338.46685</td>
<td align="left">14371.38650</td>
<td align="left">32.91965</td>
</tr>
<tr class="odd">
<td align="left">LL</td>
<td align="left">-7151.765593</td>
<td align="left">-7150.757587</td>
<td align="left">1.008006</td>
</tr>
<tr class="even">
<td align="left">LLDF</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">Sigma</td>
<td align="left">7.244037e-01</td>
<td align="left">7.244031e-01</td>
<td align="left">-5.615116e-07</td>
</tr>
<tr class="even">
<td align="left">MarginalR2</td>
<td align="left">0.011454545</td>
<td align="left">0.017427470</td>
<td align="left">0.005972925</td>
</tr>
<tr class="odd">
<td align="left">ConditionalR2</td>
<td align="left">5.475067e-01</td>
<td align="left">5.475264e-01</td>
<td align="left">1.972412e-05</td>
</tr>
<tr class="even">
<td align="left">MarginalF2</td>
<td align="left">0.011587272</td>
<td align="left">0.017736574</td>
<td align="left">0.006078864</td>
</tr>
<tr class="odd">
<td align="left">ConditionalF2</td>
<td align="left">1.209977e+00</td>
<td align="left">1.210074e+00</td>
<td align="left">4.359177e-05</td>
</tr>
<tr class="even">
<td align="left">Chi2</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2.016012</td>
</tr>
<tr class="odd">
<td align="left">P</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0.7328137</td>
</tr>
</tbody>
</table>
<p>These results match with those from <code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> shown in
the following table. Comparing the p-value for <code>SEScat</code> under
the effect sizes section with the model comparison.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest</a></span><span class="op">(</span><span class="va">m.noint</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameters and CIs are based on REML, </span></span>
<span><span class="co">#&gt; but modelTests requires ML not REML fit for comparisons, </span></span>
<span><span class="co">#&gt; and these are used in effect sizes. Refitting.</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Term</th>
<th align="left">Est</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">2.63*** [ 2.32, 2.94]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1</td>
<td align="left">0.21 [-0.04, 0.46]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">SEScat5</td>
<td align="left">-0.17 [-0.57, 0.23]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">SEScat6</td>
<td align="left">0.03 [-0.37, 0.43]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">SEScat7</td>
<td align="left">0.02 [-0.35, 0.39]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">SEScat8</td>
<td align="left">0.09 [-0.36, 0.54]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">sd_(Intercept)|UserID</td>
<td align="left">0.80</td>
<td align="left">Random Effects</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="left">0.72</td>
<td align="left">Random Effects</td>
</tr>
<tr class="odd">
<td align="left">Model DF</td>
<td align="left">8</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">N (Groups)</td>
<td align="left">UserID (185)</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">N (Observations)</td>
<td align="left">6210</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">logLik</td>
<td align="left">-7150.76</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">AIC</td>
<td align="left">14317.52</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">BIC</td>
<td align="left">14371.39</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Marginal R2</td>
<td align="left">0.02</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Marginal F2</td>
<td align="left">0.02</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Conditional R2</td>
<td align="left">0.55</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Conditional F2</td>
<td align="left">1.21</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat (Fixed)</td>
<td align="left">0.01/0.00, p = .098</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">SEScat (Fixed)</td>
<td align="left">0.01/0.00, p = .733</td>
<td align="left">Effect Sizes</td>
</tr>
</tbody>
</table>
<p>Now let’s look at what happens when there is an interaction.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">PosAff</span> <span class="op">~</span> <span class="va">BornAUScat</span> <span class="op">*</span> <span class="va">SEScat</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">UserID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></code></pre></div>
<p>Here are the fixed effeccts for the model with an interaction
involving a categorical predictor.</p>
<table class="table">
<caption>interaction model fixed effects</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6206523</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1</td>
<td align="right">0.2408151</td>
</tr>
<tr class="odd">
<td align="left">SEScat5</td>
<td align="right">-0.2502179</td>
</tr>
<tr class="even">
<td align="left">SEScat6</td>
<td align="right">0.0017685</td>
</tr>
<tr class="odd">
<td align="left">SEScat7</td>
<td align="right">0.0643894</td>
</tr>
<tr class="even">
<td align="left">SEScat8</td>
<td align="right">0.3253807</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat1:SEScat5</td>
<td align="right">0.3284179</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat6</td>
<td align="right">0.0746243</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat1:SEScat7</td>
<td align="right">-0.1382994</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat8</td>
<td align="right">-0.3894738</td>
</tr>
</tbody>
</table>
<p>Now, suppose that we decided to drop one of the predictors from the
model. We can update the model using the <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> function
built into <code>R</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.intdrop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m.int</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">SEScat</span><span class="op">)</span></span></code></pre></div>
<p>Here are the fixed effects for the model with an interaction after
dropping categorical subjective socioeconomic status
(<code>SEScat</code>).</p>
<table class="table">
<caption>interaction model fixed effects after dropping a
predictor</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6206523</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1</td>
<td align="right">0.2408151</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat0:SEScat5</td>
<td align="right">-0.2502179</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat5</td>
<td align="right">0.0781999</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat0:SEScat6</td>
<td align="right">0.0017685</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat6</td>
<td align="right">0.0763928</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat0:SEScat7</td>
<td align="right">0.0643894</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat7</td>
<td align="right">-0.0739101</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat0:SEScat8</td>
<td align="right">0.3253807</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat8</td>
<td align="right">-0.0640931</td>
</tr>
</tbody>
</table>
<p>You can see immediately that we have the same number of fixed effects
coefficients. Before, we had the simple main effects of
<code>SEScat</code> and then how those differed when
<code>BornAUScat = 1</code>. Now, we have the simple main effects for
both <code>BornAUScat = 0</code> and <code>BornAUScat = 1</code>. This
happens because of <code>R</code>’s formula interface and how it decides
to dummy code and create the underlying model matrix.</p>
<p>If we tried the following code to compare these two models, we would
get an error about the models not being nested.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelCompare.html" class="external-link">modelCompare</a></span><span class="op">(</span><span class="va">m.intdrop</span>, <span class="va">m.int</span><span class="op">)</span></span></code></pre></div>
<p>The models are <em>not</em> nested within each other. In fact, they
are the same model, just parameterized differently. For example, this
can be seen by comparing the log likelihoods, which are the same.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">m.int</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -7156.232 (df=12)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">m.intdrop</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -7156.232 (df=12)</span></span></code></pre></div>
<p>What we might have wanted is what would have happened if we
constrained the fixed effects for the <code>SEScat</code> dummy codes to
0. That, however, is tricky to obtain.</p>
<p><code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> tries to fail relatively gracefully. It will
run, but not report a test for the simple main effect overall of
<code>SEScat</code>. It can, however, test whether the two-way
interaction adds beyond the main effects only.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest</a></span><span class="op">(</span><span class="va">m.int</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameters and CIs are based on REML, </span></span>
<span><span class="co">#&gt; but modelTests requires ML not REML fit for comparisons, </span></span>
<span><span class="co">#&gt; and these are used in effect sizes. Refitting.</span></span>
<span><span class="co">#&gt; The full and reduced model had 12 and 12 parameters, respectively.</span></span>
<span><span class="co">#&gt; The reduced model should have fewer parameters.</span></span>
<span><span class="co">#&gt; This usually happens when there are interactions with categorical variables.</span></span>
<span><span class="co">#&gt; For an explanation, see:</span></span>
<span><span class="co">#&gt; https://joshuawiley.com/multilevelTools/articles/lmer-vignette.html</span></span>
<span><span class="co">#&gt; The full and reduced model had 12 and 12 parameters, respectively.</span></span>
<span><span class="co">#&gt; The reduced model should have fewer parameters.</span></span>
<span><span class="co">#&gt; This usually happens when there are interactions with categorical variables.</span></span>
<span><span class="co">#&gt; For an explanation, see:</span></span>
<span><span class="co">#&gt; https://joshuawiley.com/multilevelTools/articles/lmer-vignette.html</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Term</th>
<th align="left">Est</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">2.62*** [ 2.27, 2.98]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1</td>
<td align="left">0.24 [-0.46, 0.94]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat1:SEScat5</td>
<td align="left">0.33 [-0.60, 1.25]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat6</td>
<td align="left">0.07 [-0.81, 0.96]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat1:SEScat7</td>
<td align="left">-0.14 [-0.96, 0.69]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUScat1:SEScat8</td>
<td align="left">-0.39 [-1.35, 0.57]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">SEScat5</td>
<td align="left">-0.25 [-0.71, 0.21]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">SEScat6</td>
<td align="left">0.00 [-0.48, 0.48]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">SEScat7</td>
<td align="left">0.06 [-0.37, 0.50]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">SEScat8</td>
<td align="left">0.33 [-0.31, 0.96]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">sd_(Intercept)|UserID</td>
<td align="left">0.80</td>
<td align="left">Random Effects</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="left">0.72</td>
<td align="left">Random Effects</td>
</tr>
<tr class="odd">
<td align="left">Model DF</td>
<td align="left">12</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">N (Groups)</td>
<td align="left">UserID (185)</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">N (Observations)</td>
<td align="left">6210</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">logLik</td>
<td align="left">-7149.26</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">AIC</td>
<td align="left">14322.53</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">BIC</td>
<td align="left">14403.34</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Marginal R2</td>
<td align="left">0.03</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Marginal F2</td>
<td align="left">0.03</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Conditional R2</td>
<td align="left">0.55</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Conditional F2</td>
<td align="left">1.21</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat (Fixed)</td>
<td align="left">NA/ NA, NA</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">SEScat (Fixed)</td>
<td align="left">NA/ NA, NA</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="odd">
<td align="left">BornAUScat:SEScat (Fixed)</td>
<td align="left">0.01/0.00, p = .560</td>
<td align="left">Effect Sizes</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="if-you-really-want">If you really want<a class="anchor" aria-label="anchor" href="#if-you-really-want"></a>
</h4>
<p>What if you really want those tests for the simple main effects of a
categorical predictor? This can be done by manually dummy coding
predictors and creating the two, nested, models to compare.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## manually dummy code</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">SEScat5</span> <span class="op">:=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">SES_1</span> <span class="op">==</span> <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">SEScat6</span> <span class="op">:=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">SES_1</span> <span class="op">==</span> <span class="fl">6</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">SEScat7</span> <span class="op">:=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">SES_1</span> <span class="op">==</span> <span class="fl">7</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">SEScat8</span> <span class="op">:=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">SES_1</span> <span class="op">==</span> <span class="fl">8</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## interaction model</span></span>
<span><span class="va">m.intman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">PosAff</span> <span class="op">~</span> <span class="va">BornAUS</span> <span class="op">*</span> <span class="op">(</span><span class="va">SEScat5</span> <span class="op">+</span> <span class="va">SEScat6</span> <span class="op">+</span> <span class="va">SEScat7</span> <span class="op">+</span> <span class="va">SEScat8</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">UserID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## drop just the simple main effects of SEScat</span></span>
<span><span class="va">m.intmandrop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m.intman</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">SEScat5</span> <span class="op">-</span> <span class="va">SEScat6</span> <span class="op">-</span> <span class="va">SEScat7</span> <span class="op">-</span> <span class="va">SEScat8</span><span class="op">)</span></span></code></pre></div>
<p>Now we can compare the two models. As expected, they differ by 4
degrees of freedom.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelCompare.html" class="external-link">modelCompare</a></span><span class="op">(</span><span class="va">m.intmandrop</span>, <span class="va">m.intman</span><span class="op">)</span><span class="op">$</span><span class="va">Comparison</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"manual model comparison"</span><span class="op">)</span></span>
<span><span class="co">#&gt; When using REML, the fixed effects structure must be identical,</span></span>
<span><span class="co">#&gt; but was different. Refitting with ML.</span></span></code></pre></div>
<table class="table">
<caption>manual model comparison</caption>
<tbody>
<tr class="odd">
<td align="left">Model</td>
<td align="left">Model 1</td>
<td align="left">Model 2</td>
<td align="left">Difference</td>
</tr>
<tr class="even">
<td align="left">Estimator</td>
<td align="left">ML</td>
<td align="left">ML</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">N_Obs</td>
<td align="left">6210</td>
<td align="left">6210</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">N_Groups</td>
<td align="left">UserID (185)</td>
<td align="left">UserID (185)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">AIC</td>
<td align="left">14319.07236</td>
<td align="left">14322.52961</td>
<td align="left">3.45726</td>
</tr>
<tr class="even">
<td align="left">BIC</td>
<td align="left">14372.94368</td>
<td align="left">14403.33661</td>
<td align="left">30.39292</td>
</tr>
<tr class="odd">
<td align="left">LL</td>
<td align="left">-7151.53618</td>
<td align="left">-7149.26481</td>
<td align="left">2.27137</td>
</tr>
<tr class="even">
<td align="left">LLDF</td>
<td align="left">8</td>
<td align="left">12</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">Sigma</td>
<td align="left">7.244035e-01</td>
<td align="left">7.244022e-01</td>
<td align="left">-1.322381e-06</td>
</tr>
<tr class="even">
<td align="left">MarginalR2</td>
<td align="left">0.01283841</td>
<td align="left">0.02618203</td>
<td align="left">0.01334362</td>
</tr>
<tr class="odd">
<td align="left">ConditionalR2</td>
<td align="left">5.475208e-01</td>
<td align="left">5.475707e-01</td>
<td align="left">4.986076e-05</td>
</tr>
<tr class="even">
<td align="left">MarginalF2</td>
<td align="left">0.01300538</td>
<td align="left">0.02688596</td>
<td align="left">0.01370238</td>
</tr>
<tr class="odd">
<td align="left">ConditionalF2</td>
<td align="left">1.2100465035</td>
<td align="left">1.2102900655</td>
<td align="left">0.0001102067</td>
</tr>
<tr class="even">
<td align="left">Chi2</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">4.54274</td>
</tr>
<tr class="odd">
<td align="left">P</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0.3375096</td>
</tr>
</tbody>
</table>
<p>Incidentally, while you can still use <code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> with
this model, <code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> no longer knows that SEScat5 to 8
belong to the same variable, so they are tested individually, and you do
not get the omnibus test.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest</a></span><span class="op">(</span><span class="va">m.intman</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameters and CIs are based on REML, </span></span>
<span><span class="co">#&gt; but modelTests requires ML not REML fit for comparisons, </span></span>
<span><span class="co">#&gt; and these are used in effect sizes. Refitting.</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Term</th>
<th align="left">Est</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">2.62*** [ 2.27, 2.98]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUS</td>
<td align="left">0.24 [-0.46, 0.94]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">BornAUS:SEScat5</td>
<td align="left">0.33 [-0.60, 1.25]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUS:SEScat6</td>
<td align="left">0.07 [-0.81, 0.96]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">BornAUS:SEScat7</td>
<td align="left">-0.14 [-0.96, 0.69]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">BornAUS:SEScat8</td>
<td align="left">-0.39 [-1.35, 0.57]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">SEScat5</td>
<td align="left">-0.25 [-0.71, 0.21]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">SEScat6</td>
<td align="left">0.00 [-0.48, 0.48]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">SEScat7</td>
<td align="left">0.06 [-0.37, 0.50]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">SEScat8</td>
<td align="left">0.33 [-0.31, 0.96]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">sd_(Intercept)|UserID</td>
<td align="left">0.80</td>
<td align="left">Random Effects</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="left">0.72</td>
<td align="left">Random Effects</td>
</tr>
<tr class="odd">
<td align="left">Model DF</td>
<td align="left">12</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">N (Groups)</td>
<td align="left">UserID (185)</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">N (Observations)</td>
<td align="left">6210</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">logLik</td>
<td align="left">-7149.26</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">AIC</td>
<td align="left">14322.53</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">BIC</td>
<td align="left">14403.34</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Marginal R2</td>
<td align="left">0.03</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Marginal F2</td>
<td align="left">0.03</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Conditional R2</td>
<td align="left">0.55</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Conditional F2</td>
<td align="left">1.21</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">BornAUS (Fixed)</td>
<td align="left">0.00/0.00, p = .487</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">SEScat5 (Fixed)</td>
<td align="left">0.00/0.00, p = .279</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="odd">
<td align="left">SEScat6 (Fixed)</td>
<td align="left">0.00/0.00, p = .994</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">SEScat7 (Fixed)</td>
<td align="left">0.00/0.00, p = .765</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="odd">
<td align="left">SEScat8 (Fixed)</td>
<td align="left">0.00/0.00, p = .304</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">BornAUS:SEScat5 (Fixed)</td>
<td align="left">0.00/0.00, p = .475</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="odd">
<td align="left">BornAUS:SEScat6 (Fixed)</td>
<td align="left">0.00/0.00, p = .865</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">BornAUS:SEScat7 (Fixed)</td>
<td align="left">0.00/0.00, p = .736</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="odd">
<td align="left">BornAUS:SEScat8 (Fixed)</td>
<td align="left">0.00/0.00, p = .415</td>
<td align="left">Effect Sizes</td>
</tr>
</tbody>
</table>
<p>The general principle is that with categorical variables,
<code><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest()</a></code> will support the highest order interaction in
the model, but none of the lower order interactions or main effects.</p>
<p>Thus with a two-way interaction, the two-way interaction can be
tested but not the simple main effects involved. With a three-way
interaction, the three-way interaction can be tested but not the simple
two-way interactions nor the simiple main effects involved. Any of these
can be tested manually using <code><a href="https://joshuawiley.com/JWileymisc/reference/modelCompare.html" class="external-link">modelCompare()</a></code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="interactions-with-continuous-variables">Interactions with Continuous Variables<a class="anchor" aria-label="anchor" href="#interactions-with-continuous-variables"></a>
</h3>
<p>Continuous interactions do not pose the same challenges and in
<code>R</code> we can easily remove specific simple components to test
whether they differ from zero.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.cint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">PosAff</span> <span class="op">~</span> <span class="va">STRESS</span> <span class="op">*</span> <span class="va">NegAff</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">UserID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">aces_daily</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/APAStyler.html" class="external-link">APAStyler</a></span><span class="op">(</span><span class="fu"><a href="https://joshuawiley.com/JWileymisc/reference/modelTest.html" class="external-link">modelTest</a></span><span class="op">(</span><span class="va">m.cint</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameters and CIs are based on REML, </span></span>
<span><span class="co">#&gt; but modelTests requires ML not REML fit for comparisons, </span></span>
<span><span class="co">#&gt; and these are used in effect sizes. Refitting.</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Term</th>
<th align="left">Est</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">3.85*** [ 3.73, 3.98]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">NegAff</td>
<td align="left">-0.61*** [-0.66, -0.56]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">STRESS</td>
<td align="left">-0.21*** [-0.23, -0.20]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="even">
<td align="left">STRESS:NegAff</td>
<td align="left">0.06*** [ 0.05, 0.07]</td>
<td align="left">Fixed Effects</td>
</tr>
<tr class="odd">
<td align="left">sd_(Intercept)|UserID</td>
<td align="left">0.72</td>
<td align="left">Random Effects</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="left">0.62</td>
<td align="left">Random Effects</td>
</tr>
<tr class="odd">
<td align="left">Model DF</td>
<td align="left">6</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">N (Groups)</td>
<td align="left">UserID (191)</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">N (Observations)</td>
<td align="left">6386</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">logLik</td>
<td align="left">-6405.06</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">AIC</td>
<td align="left">12822.13</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">BIC</td>
<td align="left">12862.70</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Marginal R2</td>
<td align="left">0.21</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Marginal F2</td>
<td align="left">0.27</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">Conditional R2</td>
<td align="left">0.66</td>
<td align="left">Overall Model</td>
</tr>
<tr class="even">
<td align="left">Conditional F2</td>
<td align="left">1.94</td>
<td align="left">Overall Model</td>
</tr>
<tr class="odd">
<td align="left">STRESS (Fixed)</td>
<td align="left">0.07/0.10, p &lt; .001</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="even">
<td align="left">NegAff (Fixed)</td>
<td align="left">0.08/0.11, p &lt; .001</td>
<td align="left">Effect Sizes</td>
</tr>
<tr class="odd">
<td align="left">STRESS:NegAff (Fixed)</td>
<td align="left">0.02/0.03, p &lt; .001</td>
<td align="left">Effect Sizes</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://joshuawiley.com" class="external-link">Joshua F. Wiley</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
