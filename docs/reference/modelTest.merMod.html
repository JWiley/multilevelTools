<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>estimate detailed results per variable and effect sizes for both fixed and random effects from lmer models — modelTest.merMod • multilevelTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="estimate detailed results per variable and effect sizes for both fixed and random effects from lmer models — modelTest.merMod" />
<meta property="og:description" content="This function extends the current drop1 method for
merMod class objects from the lme4 package. Where
the default method to be able to drop both fixed and random
effects at once." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multilevelTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/lmer-vignette.html">Multilevel Models using lmer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JWiley/multilevelTools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>estimate detailed results per variable and effect sizes for both fixed and random effects from lmer models</h1>
    <small class="dont-index">Source: <a href='https://github.com/JWiley/multilevelTools/blob/master/R/models.R'><code>R/models.R</code></a></small>
    <div class="hidden name"><code>modelTest.merMod.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function extends the current <code>drop1</code> method for
<code>merMod</code> class objects from the lme4 package. Where
the default method to be able to drop both fixed and random
effects at once.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for merMod</span>
<span class='fu'>modelTest</span>(<span class='no'>object</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Wald"</span>, <span class='st'>"profile"</span>, <span class='st'>"boot"</span>), <span class='no'>control</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <code>merMod</code> class object, the fitted result of
<code>lmer</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character vector indicating the types of confidence
intervals to calculate. One of &#8220;Wald&#8221;, &#8220;profile&#8221;, or
&#8220;boot&#8221;.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A <code>lmerControl()</code> results used to control how
models are estimated when updating.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code>confint</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>At the moment, the function is aimed to <code>lmer</code> models
and has very few features for <code>glmer</code> or <code>nlmer</code>
models. The primary motivation was to provide a way to
provide an overall test of whether a variable
&#8220;matters&#8221;.  In multilevel data, a variable may be
included in both the fixed and random effects. To provide
an overall test of whether it matters requires jointly testing
the fixed and random effects. This also is needed to provide
an overall effect size.</p>
<p>The function works by generating a formula with one specific
variable or &#8220;term&#8221; removed at all levels. A model is then
fit on this reduced formula and compared to the full model passed
in. This is a complex operation for mixed effects models for several
reasons. Firstly, <code>R</code> has no default mechanism for dropping
terms from both the fixed and random portions. Secondly,
mixed effects models do not accomodate all types of models. For example,
if a model includes only a random slope with no random intercept,
if the random slope was dropped, there would be no more random effects,
and at that point, <code>lmer</code> or <code>glmer</code> will not run the model.
It is theoretically possible to instead fit the model using
<code>lm</code> or <code>glm</code> but this becomes more complex for certain
model comparisons and calculations and is not currently implemented.
Marginal and conditional R2 values are calculated for each term,
and these are used also to calculate something akin to an
f-squared effect size.</p>
<p>This is a new function and it is important to carefully evaluate
the results and check that they are accurate and that they are
sensible. Check accuracy by viewing the model formulae for each
reduced model and checking that those are indeed accurate.
In terms of checking whether a result is sensible or not,
there is a large literature on the difficulty interpretting
main effect tests in the presence of interactions. As it is
challenging to detect all interactions, especially ones that are
made outside of <code>R</code> formulae, all terms are tested. However,
it likely does not make sense to report results from dropping a
main effect but keeping the interaction term, so present
and interpret these with caution.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## these examples are slow to run</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>JWileymisc</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lme4</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span>(<span class='no'>extra</span> ~ <span class='no'>group</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>ID</span>),
<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sleep</span>, <span class='kw'>REML</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/pkg/JWileymisc/man/modelTest.html'>modelTest</a></span>(<span class='no'>m1</span>)</div><div class='output co'>#&gt; $FixedEffects
#&gt;           Term  Est Type         LL       UL         Pval
#&gt; 1: (Intercept) 0.75   FE -0.3663711 1.866371 1.879250e-01
#&gt; 2:      group2 1.58   FE  0.8567759 2.303224 1.853388e-05
#&gt; 
#&gt; $RandomEffects
#&gt;                 Term       Est Type LL UL
#&gt; 1: sd_(Intercept)|ID 1.6010934   RE NA NA
#&gt; 2:             sigma 0.8251061   RE NA NA
#&gt; 
#&gt; $EffectSizes
#&gt;    Variable Estimator N_Obs N_Groups       AIC       BIC       LL LLDF
#&gt; 1:    group               0          -8.414884 -7.419152 5.207442    1
#&gt;         Sigma MarginalR2 ConditionalR2 MarginalF2 ConditionalF2     Chi2
#&gt; 1: -0.5637784  0.1613328     0.3226657  0.1923682      1.833431 10.41488
#&gt;              P   FE    RE              Formula  Type
#&gt; 1: 0.001250037 TRUE FALSE extra ~ 1 + (1 | ID) Fixed
#&gt; 
#&gt; $OverallModel
#&gt; $Performance
#&gt;     Model Estimator N_Obs N_Groups      AIC      BIC        LL LLDF     Sigma
#&gt; 1: merMod        ML    20  ID (10) 78.50469 82.48762 -35.25235    4 0.8251061
#&gt;    MarginalR2 ConditionalR2 MarginalF2 ConditionalF2
#&gt; 1:  0.1613328     0.8240099  0.1923682      4.682139
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "modelPerformance.merMod" "modelPerformance"       
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "modelTest.merMod" "modelTest"       </div><div class='input'>
<span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>aces_daily</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"JWileymisc"</span>)

<span class='no'>strictControl</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lme4</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmerControl.html'>lmerControl</a></span>(<span class='kw'>optCtrl</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
   <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"NLOPT_LN_NELDERMEAD"</span>,
   <span class='kw'>xtol_abs</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>,
   <span class='kw'>ftol_abs</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>))

<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lme4</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span>(<span class='no'>NegAff</span> ~ <span class='no'>STRESS</span> + (<span class='fl'>1</span> + <span class='no'>STRESS</span> <span class='kw'>|</span> <span class='no'>UserID</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>aces_daily</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='no'>strictControl</span>)
<span class='fu'><a href='https://rdrr.io/pkg/JWileymisc/man/modelTest.html'>modelTest</a></span>(<span class='no'>m1</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"profile"</span>)</div><div class='output co'>#&gt; <span class='message'>Computing profile confidence intervals ...</span></div><div class='output co'>#&gt; <span class='message'>Parameters and CIs are based on REML, </span>
#&gt; <span class='message'>but modelTests requires ML not REML fit for comparisons, </span>
#&gt; <span class='message'>and these are used in effect sizes. Refitting.</span></div><div class='output co'>#&gt; $FixedEffects
#&gt;           Term       Est Type        LL        UL Pval
#&gt; 1: (Intercept) 1.2357011   FE 1.2024389 1.2692167    0
#&gt; 2:      STRESS 0.1183128   FE 0.1068207 0.1296297    0
#&gt; 
#&gt; $RandomEffects
#&gt;                             Term        Est Type         LL         UL
#&gt; 1: cor_STRESS.(Intercept)|UserID 0.47080710   RE 0.28594503 0.63920496
#&gt; 2:         sd_(Intercept)|UserID 0.20584754   RE 0.17824126 0.23575939
#&gt; 3:              sd_STRESS|UserID 0.06769562   RE 0.05902194 0.07720673
#&gt; 4:                         sigma 0.41789650   RE 0.41053223 0.42549600
#&gt; 
#&gt; $EffectSizes
#&gt;    Variable Estimator N_Obs N_Groups        AIC        BIC        LL LLDF
#&gt; 1:   STRESS               0          -2701.2231 -2680.9361 1353.6115    3
#&gt; 2:   STRESS               0           -538.1871  -524.6625  271.0936    2
#&gt;          Sigma  MarginalR2 ConditionalR2  MarginalF2 ConditionalF2      Chi2
#&gt; 1: -0.10192042  0.22744094    0.11496663  0.29439943     0.2560813 2707.2231
#&gt; 2: -0.02275066 -0.04844019    0.01044791 -0.06270095     0.0232721  542.1871
#&gt;                P    FE   RE                            Formula           Type
#&gt; 1:  0.000000e+00  TRUE TRUE          NegAff ~ 1 + (1 | UserID) Fixed + Random
#&gt; 2: 1.843162e-118 FALSE TRUE NegAff ~ 1 + STRESS + (1 | UserID)         Random
#&gt; 
#&gt; $OverallModel
#&gt; $Performance
#&gt;     Model Estimator N_Obs     N_Groups      AIC      BIC        LL LLDF
#&gt; 1: merMod        ML  6389 UserID (191) 7702.815 7743.389 -3845.407    6
#&gt;        Sigma MarginalR2 ConditionalR2 MarginalF2 ConditionalF2
#&gt; 1: 0.4179028  0.2274409     0.5510541  0.2943994       1.22744
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "modelPerformance.merMod" "modelPerformance"       
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "modelTest.merMod" "modelTest"       </div><div class='input'>
<span class='no'>m2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lme4</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span>(<span class='no'>NegAff</span> ~ <span class='no'>STRESS</span> + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>STRESS</span>^<span class='fl'>2</span>) + (<span class='fl'>1</span> + <span class='no'>STRESS</span> <span class='kw'>|</span> <span class='no'>UserID</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>aces_daily</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='no'>strictControl</span>)

<span class='co'>## might normally use more bootstraps but keeping low for faster run</span>
<span class='fu'><a href='https://rdrr.io/pkg/JWileymisc/man/modelTest.html'>modelTest</a></span>(<span class='no'>m2</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"boot"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; <span class='message'>Computing bootstrap confidence intervals ...</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>1 warning(s): Model failed to converge with max|grad| = 0.00222261 (tol = 0.002, component 1)</span></div><div class='output co'>#&gt; <span class='message'>Parameters and CIs are based on REML, </span>
#&gt; <span class='message'>but modelTests requires ML not REML fit for comparisons, </span>
#&gt; <span class='message'>and these are used in effect sizes. Refitting.</span></div><div class='output co'>#&gt; $FixedEffects
#&gt;           Term         Est Type          LL          UL         Pval
#&gt; 1: (Intercept) 1.255682188   FE 1.218592743 1.287885765 0.000000e+00
#&gt; 2: I(STRESS^2) 0.003907478   FE 0.002066481 0.005704836 4.873061e-05
#&gt; 3:      STRESS 0.092421665   FE 0.075694182 0.109085934 0.000000e+00
#&gt; 
#&gt; $RandomEffects
#&gt;                             Term        Est Type         LL        UL
#&gt; 1: cor_STRESS.(Intercept)|UserID 0.46480701   RE 0.26388784 0.6916568
#&gt; 2:         sd_(Intercept)|UserID 0.21407800   RE 0.18924474 0.2440853
#&gt; 3:              sd_STRESS|UserID 0.06437972   RE 0.05339639 0.0701088
#&gt; 4:                         sigma 0.41744838   RE 0.41013609 0.4266621
#&gt; 
#&gt; $EffectSizes
#&gt;       Variable Estimator N_Obs N_Groups        AIC         BIC         LL LLDF
#&gt; 1:      STRESS               0          -520.66418 -500.377178 263.332089    3
#&gt; 2:      STRESS               0          -438.87694 -425.352274 221.438470    2
#&gt; 3: I(STRESS^2)               0           -13.62524   -6.862912   7.812622    1
#&gt;            Sigma  MarginalR2 ConditionalR2  MarginalF2 ConditionalF2      Chi2
#&gt; 1: -0.0218673846 -0.02493856   0.013746427 -0.03270762   0.030804834 526.66418
#&gt; 2: -0.0191993031 -0.04324950   0.007824503 -0.05672292   0.017534193 442.87694
#&gt; 3: -0.0004769974  0.01008702   0.002707476  0.01322941   0.006067274  15.62524
#&gt;                P    FE    RE                                          Formula
#&gt; 1: 7.940652e-114  TRUE  TRUE          NegAff ~ 1 + I(STRESS^2) + (1 | UserID)
#&gt; 2:  6.768529e-97 FALSE  TRUE NegAff ~ 1 + STRESS + I(STRESS^2) + (1 | UserID)
#&gt; 3:  7.721681e-05  TRUE FALSE      NegAff ~ 1 + STRESS + (1 + STRESS | UserID)
#&gt;              Type
#&gt; 1: Fixed + Random
#&gt; 2:         Random
#&gt; 3:          Fixed
#&gt; 
#&gt; $OverallModel
#&gt; $Performance
#&gt;     Model Estimator N_Obs     N_Groups     AIC      BIC        LL LLDF    Sigma
#&gt; 1: merMod        ML  6389 UserID (191) 7689.19 7736.526 -3837.595    7 0.417426
#&gt;    MarginalR2 ConditionalR2 MarginalF2 ConditionalF2
#&gt; 1:  0.2375305     0.5537575  0.3115279      1.240934
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "modelPerformance.merMod" "modelPerformance"       
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "modelTest.merMod" "modelTest"       </div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua F. Wiley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


